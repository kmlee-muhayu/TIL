# Atomic
### Atomic 변수
* Atomic 변수는 원자성을 보장하는 변수이다.
* 멀티스레드 환경에서 동기화 문제를 해결하고자 할 때 보통 `synchronized`로 락을 거는데, `synchronized`는 특정 스레드가 해당 블럭 전체에 대해 락을 걸기 때문에 다른 스레드는 아무 작업을 못하는 상황이 되어 낭비가 심하다.
* 이런 문제를 해결하기 위해 동기화 문제를 논블로킹으로 해결하기 위한 방법으로 `Atomic`이라는 개념이 나오게 되었다.

### Atomic 변수의 핵심 원리
* Atomic 변수의 동작 원리는 **CAS (Compared And Swap) 알고리즘**이다.

#### CAS (Compared And Swap) 알고리즘
* 멀티스레드 환경 또는 멀티코어 환경에서 각 CPU는 메인 메모리에서 변수값을 참조하는 게 아닌 각 CPU의 캐시 영역에서 메모리를 참조하게 된다.
* 이 때, 메인메모리에 저장된 값과 CPU 캐시에 저장된 값이 다른 경우가 있는데 이를 **가시성 문제**라고 한다.
* 가시성 문제가 발생할 때, **현재 스레드에 저장된 값과 메인메모리에 저장된 값을 비교하여 일치하는 경우 새로운 값으로 교체되고, 일치하지 않으면 실패하고 재시도한다.**
* 이러한 방법으로 CPU 캐시에 잘못된 값을 참조하는 가시성 문제를 해결하는 게 CAS 알고리즘이다.

### Atomic 변수의 기본적인 메서드
> 본 함수들은 AtomicReference 를 기준으로 작성되었다.

* `get()`: 객체에 저장된 값을 반환한다.
* `set(newValue)`: 객체에 새로운 값을 설정한다.
* `getAndSet(newValue)`: 객체에 새로운 값을 설정하고 이전 값을 반환한다.
* `compareAndSet(expect, update)`: 객체의 현재 값이 `expect`와 일치하는 경우에만 값을 `update`로 변경한다. 변경이 성공하면 `true`, 실패하면 `false`를 반환한다.
* `weakCompareAndSet(expect, update)`: `compareAndSet`과 동일한 기능을 수행하지만 약한 일관성 모드로 동작한다. 약한 일관성 모드에서는 다른 스레드가 동시에 값을 변경할 때 변경이 성공하더라도 다른 스레드에서 변경된 값을 즉시 볼 수 없을 수 있다.
* `lazySet(newValue)`: `set`과 동일한 기능을 수행하지만, 약한 일관성 모드로 동작한다. `lazySet`을 사용하여 값을 변경하는 경우, 변경된 값을 다른 스레드에서 즉시 볼 수 없을 수 있다.
* `getAndUpdate(function)`: 객체의 현재 값을 사용하여 주어진 `function`을 적용하고 새로운 값을 반환한다. 이 동작은 원자적으로 이루어진다.
* `updateAndGet(function)`: `getAndUpdate`와 동일한 기능을 수행하지만, 새로운 값을 반환하기 전에 `function`을 적용한다.

